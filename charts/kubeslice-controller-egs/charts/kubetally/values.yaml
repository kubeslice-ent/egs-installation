# Global values are automatically inherited from parent chart
# No need to duplicate them here - they come from the main values.yaml
# Only define global values here if you need subchart-specific overrides
kubetally:
  pricingService:
    image: pricing-service
    tag: 1.13.3
    imagePullPolicy: IfNotPresent
    labels:
      app: pricing-service
    annotations: {}
    containerSecurityContext:
      runAsUser: 65536
      runAsGroup: 65536
      runAsNonRoot: true
      seccompProfile:
        type: RuntimeDefault
      allowPrivilegeEscalation: false
      capabilities:
        drop:
          - ALL
      readOnlyRootFilesystem: true
    podSecurityContext: 
      runAsUser: 65536               # Non-root user
      runAsGroup: 65536              # Non-root group
      runAsNonRoot: true             # Ensure the container does not run as root
      seccompProfile:
        type: RuntimeDefault
    resources:
      requests:
        memory: "256Mi"
        cpu: "100m"
      limits:
        memory: "512Mi"
        cpu: "500m"
    tolerations:
      - operator: "Exists"
      - key: "kubeslice.io/egs"
        operator: "Equal"
        value: "dedicated-node"
        effect: "NoSchedule"
    affinity:
        nodeAffinity:
          preferredDuringSchedulingIgnoredDuringExecution:
            - weight: 100
              preference:
                matchExpressions:
                  - key: "node.kubernetes.io/gpu"
                    operator: "DoesNotExist"

  chargeUpdater:
    image: price-updater
    tag: 1.12.3
    imagePullPolicy: IfNotPresent
    annotations:
      prometheus.io/port: '9999'
      prometheus.io/scrape: 'true'
    tolerations:
      - operator: "Exists"
      - key: "kubeslice.io/egs"
        operator: "Equal"
        value: "dedicated-node"
        effect: "NoSchedule"
    containerSecurityContext:
      runAsUser: 65536
      runAsGroup: 65536
      runAsNonRoot: true
      seccompProfile:
        type: RuntimeDefault
      allowPrivilegeEscalation: false
      capabilities:
        drop:
          - ALL
      readOnlyRootFilesystem: true
    podSecurityContext: 
      runAsUser: 65536               # Non-root user
      runAsGroup: 65536              # Non-root group
      runAsNonRoot: true             # Ensure the container does not run as root
      seccompProfile:
        type: RuntimeDefault

  kubeTallyReport:
    image: kubetally-report
    tag: 1.13.5
    imagePullPolicy: IfNotPresent
    labels:
      app: report-service
    annotations: {}
    containerSecurityContext:
      runAsUser: 65536
      runAsGroup: 65536
      runAsNonRoot: true
      seccompProfile:
        type: RuntimeDefault
      allowPrivilegeEscalation: false
      capabilities:
        drop:
          - ALL
      readOnlyRootFilesystem: true
    podSecurityContext: 
      runAsUser: 65536               # Non-root user
      runAsGroup: 65536              # Non-root group
      runAsNonRoot: true             # Ensure the container does not run as root
      seccompProfile:
        type: RuntimeDefault
    resources:
      requests:
        memory: "256Mi"
        cpu: "100m"
      limits:
        memory: "512Mi"
        cpu: "500m"
    tolerations:
      - operator: "Exists"
      - key: "kubeslice.io/egs"
        operator: "Equal"
        value: "dedicated-node"
        effect: "NoSchedule"
    affinity: {}
        # nodeAffinity:
        #   preferredDuringSchedulingIgnoredDuringExecution:
        #     - weight: 100
        #       preference:
        #         matchExpressions:
        #           - key: "node.kubernetes.io/gpu"
        #             operator: "DoesNotExist"
  # imagePullSecretName is automatically inherited from parent chart's global.imagePullSecrets.name
  # Only specify this if you need a subchart-specific override
  # imagePullSecretName: "custom-subchart-secret"
